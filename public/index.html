<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Solana Token Holder Scanner</title>
<style>
body { font-family: monospace; padding: 20px; background: #f4f4f4; }
button { margin: 5px; padding: 5px 10px; }
pre { background: #fff; padding: 10px; border: 1px solid #ccc; max-height: 600px; overflow: auto; }
</style>
</head>
<body>
<h1>Solana Token Holder Scanner</h1>
<input id="mintInput" placeholder="Enter token mint" size="60">
<button id="startBtn">Start Scan</button>
<button id="stopBtn">Stop Scan</button>
<pre id="output"></pre>

<script>
let intervalId;

async function scan() {
  const mint = document.getElementById("mintInput").value.trim();
  if (!mint) return alert("Enter a token mint");
  const output = document.getElementById("output");
  try {
    const res = await fetch("/api/scan", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ mint })
    });
    const data = await res.json();
    if (data.error) output.textContent = "Error: " + data.error;
    else output.textContent = data.output;
  } catch(e) {
    output.textContent = "Error: " + e.message;
  }
}

document.getElementById("startBtn").addEventListener("click", () => {
  if(intervalId) clearInterval(intervalId);
  scan(); // run immediately
  intervalId = setInterval(scan, 2000);
});

document.getElementById("stopBtn").addEventListener("click", () => {
  clearInterval(intervalId);
});
</script>
</body>
</html>
